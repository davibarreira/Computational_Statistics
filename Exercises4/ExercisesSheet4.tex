\documentclass[12pt,letterpaper]{article}
\usepackage{./preamble}
\usepackage{amsmath}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Edit These for yourself
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand\course{Computational Statistics}
\newcommand\hwnumber{4}
\newcommand\userID{Davi Sales Barreira}
\DeclareRobustCommand{\rchi}{{\mathpalette\irchi\relax}}
\newcommand{\irchi}[2]{\raisebox{\depth}{$#1\chi$}}
\newcommand*{\QEDA}{\hfill\ensuremath{\blacksquare}}%

\begin{document}
% \textbf{\Large Worksheet completed with Octave.}

\section*{Exercise 1 (Kalma Filter)}
\begin{enumerate}[leftmargin=!,labelindent=5pt]
\item 
$$
f(X_t \mid X_{t-1}) \sim N(\phi X_{t-1}, \sigma_v^2)
$$
$$
g(Y_t \mid X_{t}) \sim N(\phi X_{t}, \sigma_w^2)
$$

\item Note that $X_{t+1} = \phi X_t + V_t$. Then:
$$
X_{t+1} \mid Y_{1:t} = \phi X_t + V_t \mid Y_{1:t}
$$
Therefore, since
$X_t \mid Y_{1:t} \sim N(m_{t\mid t}, \sigma^2_{t\mid t})$ and
$V_t \sim N(0, \sigma_v^2)$, we have the sum of normals, hence:
$$
X_{t+1} \mid Y_{1:t} \sim N(m_{t\mid t}, \sigma_v^2 +
\phi^2 \sigma^2_{t\mid t})
$$

\item Note that:
$$
p(X_{t=1} \mid Y_{1:t},Y_{t+1}) \propto
N(X_{t+1},\sigma_w^2)N(m_{t+1}, \sigma_{t+1}^2)
$$

The update of normal distribution by normal distribution is given by:
$$
\mu_1 = \frac{y_{t+1}\sigma_w ^{-2} + m_{t+1}\sigma_{t+1}^2}
{\sigma_w^{-2} + \sigma_{t+1}^{-2}}
\quad \quad
\tau_1^2 = (\sigma_w^{-2}+\sigma_v^{-2})^{-1}
$$
Hence, $p(x_{t+1} \mid y_{1:t}) = N(\mu_1, \tau_1^2) =
N(m_{t+1\mid t},\sigma^2_{t+1 \mid t})$.

\item Note that:
$$
Y_{t+1} \mid Y_{1:t} = X_{t+1} + W_{t+1} \mid Y_{1:t} =
N(\mu_1,\tau_1) + N(0, \sigma_w ^2)
$$

$$
Y_{t+1} \mid Y_{1:t} = N(\mu_1,
\sigma_w^2 + \tau_1^2)
$$

\end{enumerate}
\end{document}
